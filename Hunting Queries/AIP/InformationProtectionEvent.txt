InformationProtectionLogs_CL |  where columnifexists('Operation_s','') !in ('Heartbeat','') |  project Time = TimeGenerated,
                                                    User = columnifexists('UserId_s',''),
                                                    ItemPath = columnifexists('ObjectId_s',''),
                                                    ItemName =  columnifexists('ObjectId_s',''),
                                                    Method = columnifexists('ActionSource_s',''),
                                                    Activity = columnifexists('Activity_s',''),
                                                    LabelName = columnifexists('LabelName_s',''),
                                                    LabelNameBefore = columnifexists('LabelNameBefore_s',''),
                                                    ProtectionType = columnifexists('ProtectionType_s',''),
                                                    ProtectionBefore = columnifexists('ProtectionBefore_g',''),
                                                    MachineName = columnifexists('MachineName_s',''),
                                                    DeviceRisk = columnifexists('DeviceRisk_s',''),
                                                    Platform = columnifexists('Platform_s',''),
                                                    ApplicationName = columnifexists('ApplicationName_s',''),
                                                    TenantId = AadTenantId_g,
                                                    AzureApplicationId = columnifexists('ApplicationId_g',''),
                                                    ProcessName = columnifexists('ProcessName_s',''),
                                                    LabelId = columnifexists('LabelId_g',''),
                                                    IsProtected = columnifexists('Protected_b',false),
                                                    ProtectionOwner = columnifexists('ProtectionOwner_s',''),
                                                    TemplateId_g = columnifexists('TemplateId_g',''),
                                                    LabelIdBefore = columnifexists('LabelIdBefore_g',''),
                                                    InformationTypesAbove55 = columnifexists('InformationTypesAbove55_s','[]'),
                                                    InformationTypesAbove65 = columnifexists('InformationTypesAbove65_s','[]'),
                                                    InformationTypesAbove75 = columnifexists('InformationTypesAbove75_s','[]'),
                                                    InformationTypesAbove85 = columnifexists('InformationTypesAbove85_s','[]'),
                                                    InformationTypesAbove95 = columnifexists('InformationTypesAbove95_s','[]'),
                                                    InformationTypes = columnifexists('InformationTypes_s','[]'),
                                                    DiscoveredInformationTypes = columnifexists('DiscoveredInformationTypes_s','[]'),
                                                    ProtectedBefore = columnifexists('ProtectedBefore_b', false),
                                                    ProtectionOwnerBefore = columnifexists('ProtectionOwnerBefore_s',''),
                                                    UserJustification = columnifexists('UserJustification_s',''),
                                                    LastModifiedBy = columnifexists('LastModifiedBy_s',''), 
                                                    LastModifiedDate_s = columnifexists('LastModifiedDate_s',''),
                                                    AipVersion = columnifexists('ProductVersion_s',''),
                                                    IpAddress = columnifexists('IPv4_s','') |  extend ItemName =  iff(ApplicationName contains 'outlook',ItemName, replace(@'^.*[\\\/]', '', ItemName)) 